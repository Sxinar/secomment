<div id="admin-app" style="max-width: 500px; margin: 40px auto; font-family: sans-serif; padding: 20px;">
    <div id="login-card" style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 1px solid #eee;">
        <h2 style="text-align:center; color:#333;">Secoment Admin</h2>
        <input type="email" id="email" placeholder="Email" style="width:100%; padding:12px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
        <input type="password" id="pass" placeholder="Şifre" style="width:100%; padding:12px; margin:10px 0; border:1px solid #ddd; border-radius:8px;">
        <button onclick="login()" style="width:100%; padding:14px; background:#333; color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">Giriş Yap</button>
    </div>

    <div id="panel" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h3>Onay Bekleyenler</h3>
            <button onclick="location.reload()" style="font-size:12px;">Yenile</button>
        </div>
        <div id="pending-list"></div>
    </div>
</div>

<style>
    .admin-item { background: #fff; border: 1px solid #e1e4e8; padding: 15px; border-radius: 10px; margin-bottom: 15px; }
    .btn-approve { background: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin-right: 5px; cursor: pointer; }
    .btn-delete { background: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
    .page-tag { font-size: 11px; background: #eee; padding: 2px 6px; border-radius: 4px; color: #666; }
</style>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, collection, query, where, onSnapshot, updateDoc, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAGw79xzO43dw5Vts7f2iV6vmA_BLxBJ1A",
        authDomain: "secoment.firebaseapp.com",
        projectId: "secoment",
        storageBucket: "secoment.firebasestorage.app",
        messagingSenderId: "1028497467881",
        appId: "1:1028497467881:web:b6af0d2301ec5323120378"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    window.login = () => {
        const e = document.getElementById("email").value;
        const p = document.getElementById("pass").value;
        signInWithEmailAndPassword(auth, e, p).then(() => {
            document.getElementById("login-card").style.display = "none";
            document.getElementById("panel").style.display = "block";
            load();
        }).catch(err => alert("Hata: " + err.message));
    };

    function load() {
        const q = query(collection(db, "comments"), where("approved", "==", false));
        onSnapshot(q, (snap) => {
            let h = "";
            snap.forEach(d => {
                const data = d.data();
                h += `
                <div class="admin-item">
                    <div style="margin-bottom:10px;">
                        <b>${data.name}</b> <span class="page-tag">${data.pageId}</span>
                        <p style="margin:5px 0; font-size:14px; color:#444;">${data.text}</p>
                    </div>
                    <button class="btn-approve" onclick="approve('${d.id}')">Onayla</button>
                    <button class="btn-delete" onclick="del('${d.id}')">Sil</button>
                </div>`;
            });
            document.getElementById("pending-list").innerHTML = h || "<p>Bekleyen yorum yok, harikasın!</p>";
        });
    }

    window.approve = (id) => updateDoc(doc(db, "comments", id), { approved: true });
    window.del = (id) => deleteDoc(doc(db, "comments", id));
                          
</script>
